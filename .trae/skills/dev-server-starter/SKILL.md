---
name: "dev-server-starter"
description: "在每次代码完成后，检查并复用本地开发服务；若未运行且端口可用则启动并展示预览。用于代码完成后查看效果。"
---

# 本地服务自动启动与复用

该技能在你完成代码变更后，负责自动检查并复用现有的本地开发服务；若未运行且默认端口空闲，则启动服务并展示预览链接，避免每次占用新端口。

## 何时启用
- 完成一次代码修改/提交后需要「查看效果」
- 标记任务完成后进行本地验证
- 用户明确要求「启动本地服务」或「打开预览」

## 行为规范
1. 检查当前工作区是否已有开发服务在运行（复用终端与端口）。  
   - 识别命令形态：`npm run dev`、`next dev` 等  
   - 仅当进程工作目录是当前仓库时才视为可复用
2. 若未运行，检测默认端口是否可用（默认：3000）。  
   - 端口空闲 → 启动服务（非阻塞），设置合理等待时间捕获预览地址  
   - 端口被占用但不是本仓库服务 → 不切换到新端口，提示端口冲突（保持不新启端口的原则）
3. 展示预览链接（例如 `http://localhost:3000/`），用于快速查看页面效果。

## 启动策略
- 默认端口：3000（可按项目约定调整）
- 仅当端口空闲时才启动；否则优先复用已有服务
- 不主动终止非本仓库进程，不占用新的端口
- 启动命令示例：在仓库根目录执行 `npm run dev`（以非阻塞方式）
- 等待时间建议：500–1500ms 以捕获早期错误并获取预览 URL

## 预览展示
- 启动成功后展示可访问的预览地址（例如首页 `/`）
- 若项目提供特定页面用于验证（如新闻详情页），可追加打开 `/news/` 或最近编辑的页面

## 失败与降级
- 端口被非本仓库占用：提示冲突并指导释放端口或手动切换端口策略
- 启动错误：输出错误信息与建议（检查依赖、清理缓存 `.next`、重试）

## 配置项（可选）
- 默认端口：3000
- 等待毫秒数：1000
- 是否允许在冲突时切换到备用端口：默认关闭（保持不新占端口）

## 使用示例
- 完成样式修复后，调用本技能 → 复用或启动本地服务 → 打开 `http://localhost:3000/` 进行验证

## 安全注意
- 不杀掉非本仓库进程
- 不暴露环境变量与密钥
